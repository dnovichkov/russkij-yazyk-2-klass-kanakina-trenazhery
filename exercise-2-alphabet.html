<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–£—Ä–æ–≤–µ–Ω—å 2 ‚Äî —Å–æ–±—Ä–∞—Ç—å –∏–∑ –ø–æ–ª–Ω–æ–≥–æ –∞–ª—Ñ–∞–≤–∏—Ç–∞</title>
<style>
  body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:#f7fafc;margin:0;color:#0b1220}
  header{padding:18px;text-align:center;background:white;box-shadow:0 1px 0 rgba(0,0,0,0.04)}
  main{max-width:980px;margin:20px auto;padding:16px}
  .card{background:#fff;padding:16px;border-radius:12px;box-shadow:0 6px 20px rgba(2,6,23,0.04);margin-bottom:12px}
  .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  button{background:#0f62fe;color:#fff;padding:10px;border-radius:10px;border:0;cursor:pointer}
  .keyboard{display:flex;flex-wrap:wrap;gap:6px;margin-top:10px}
  .key{min-width:40px;min-height:40px;border-radius:8px;background:#fff;border:1px solid #e6eef8;display:flex;align-items:center;justify-content:center;cursor:pointer;user-select:none}
  .input{min-height:48px;border:1px solid #e6eef8;padding:8px;border-radius:8px;font-size:20px;display:flex;gap:6px;align-items:center}
  .kbd-row{display:flex;gap:6px}
</style>
</head>
<body>
<header>
  <h1>–£—Ä–æ–≤–µ–Ω—å 2 ‚Äî —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ –∏–∑ –ø–æ–ª–Ω–æ–≥–æ –∞–ª—Ñ–∞–≤–∏—Ç–∞</h1>
  <div style="color:#6b7280">–î–∏–∫—Ç–æ–≤–∫–∞ + –Ω–∞–∂–∞—Ç–∏–µ –±—É–∫–≤ –Ω–∞ —ç–∫—Ä–∞–Ω–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π.</div>
</header>

<main>
  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div class="controls">
        <button id="playBtn">‚ñ∂ –î–∏–∫—Ç–æ–≤–∫–∞</button>
        <button id="slowBtn" class="alt">üê¢ –ú–µ–¥–ª–µ–Ω–Ω–æ</button>
        <button id="clearBtn" class="alt">‚å´ –û—á–∏—Å—Ç–∏—Ç—å</button>
      </div>
      <div>
        <button id="submitBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        <button id="nextBtn" class="alt">–°–ª–µ–¥—É—é—â–µ–µ</button>
      </div>
    </div>

    <div style="margin-top:12px">
      <div class="input" id="answer" aria-live="polite"></div>
      <div id="feedback" style="margin-top:10px;font-weight:600"></div>
    </div>

    <div style="margin-top:12px">
      <div><strong>–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞:</strong></div>
      <div id="keyboard" class="keyboard"></div>
    </div>
  </div>

  <div class="card">
    <h3>–ü–æ–¥—Å–∫–∞–∑–∫–∏</h3>
    <ul>
      <li>–ú–æ–∂–Ω–æ –Ω–∞–±–∏—Ä–∞—Ç—å —Ç–∞–∫–∂–µ —Å —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–ª–∞—Ç. —Ä–∞—Å–∫–ª–∞–¥–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∞ –Ω–∞ —Ä—É—Å—Å–∫—É—é).</li>
      <li>–ù–∞–∂–∞—Ç–∏–µ –ø—Ä–æ–±–µ–ª–∞ –¥–æ–±–∞–≤–∏—Ç –ø—Ä–æ–±–µ–ª (–¥–ª—è —Ñ—Ä–∞–∑ —Ç–∏–ø–∞ ¬´–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è¬ª).</li>
    </ul>
  </div>
</main>

<script>
const WORDS = [
"–∞–ª—Ñ–∞–≤–∏—Ç","–∞–ø—Ä–µ–ª—å","–±–µ—Ä—ë–∑–∞","–±—ã—Å—Ç—Ä–æ","–≤–¥—Ä—É–≥","–≤–µ—Å–µ–ª–æ","–≤–µ—Ç–µ—Ä","–≤–æ—Ä–æ–±–µ–π","–≤–æ—Ä–æ–Ω–∞",
"–≥–æ—Ä–æ–¥","–¥–µ–≤–æ—á–∫–∞","–¥–µ–∂—É—Ä–Ω—ã–π","–¥–µ–∫–∞–±—Ä—å","–¥–µ—Ä–µ–≤–Ω—è","–¥–æ—Ä–æ–≥–∞","–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è",
"–∑–∞–≤–æ–¥","–∑–∞—è—Ü","–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ","–∑–µ–º–ª—è–Ω–∏–∫–∞","–∏–∑–≤–∏–Ω–∏—Ç–µ","–∏–Ω–µ–π","–∫–∞–ø—É—Å—Ç–∞","–∫–∞—Ä–∞–Ω–¥–∞—à",
"–∫–∞—Ä—Ç–∏–Ω–∞","–∫–ª–∞—Å—Å","–∫–æ–Ω—å–∫–∏","–∫–æ—Ä–æ–≤–∞","–ª–æ–ø–∞—Ç–∞","–ª—è–≥—É—à–∫–∞","–º–∞–≥–∞–∑–∏–Ω","–º–∞–ª–∏–Ω–∞","–º–∞—à–∏–Ω–∞",
"–º–µ–±–µ–ª—å","–º–µ–¥–≤–µ–¥—å","–º–µ—Å—è—Ü","–º–µ—Ç–µ–ª—å","–º–µ—Ç—Ä–æ","–º–æ–ª–æ–∫–æ","–º–æ–ª–æ—Ç–æ–∫","–º–æ—Ä–∫–æ–≤—å","–º–æ—Ä–æ–∑","–º–æ—Å–∫–≤–∞",
"–Ω–∞—Ä–æ–¥","–Ω–æ—è–±—Ä—å","–æ–±–µ–¥","–æ–±–µ–∑—å—è–Ω–∞","–æ–±–ª–∞–∫–æ","–æ–¥–µ–∂–¥–∞","–æ–∫—Ç—è–±—Ä—å","–æ—Å–∏–Ω–∞","–æ—Ç–µ—Ü",
"–ø–∞–ª—å—Ç–æ","–ø–µ–Ω–∞–ª","–ø–µ—Ç—É—Ö","–ø–ª–∞—Ç—å–µ","–ø–æ—Å—É–¥–∞","–ø—Ä–æ—â–∞–π","—Ä–∞–±–æ—Ç–∞","—Ä–∞–±–æ—á–∏–π","—Ä–µ–±—è—Ç–∞","—Ä–∏—Å—É–Ω–æ–∫",
"—Ä–æ–¥–∏–Ω–∞","—Ä–æ—Å—Å–∏—è","—Ä—É—Å—Å–∫–∏–π","—Å–∞–ø–æ–≥–∏","—Å–∞—Ö–∞—Ä","—Å–µ–Ω—Ç—è–±—Ä—å","—Å–∫–æ—Ä–æ","—Å–Ω–µ–≥–∏—Ä—å","—Å–æ–±–∞–∫–∞","—Å–æ—Ä–æ–∫–∞",
"—Å–ø–∞—Å–∏–±–æ","—Å—Ç–∞–∫–∞–Ω","—Å—É–±–±–æ—Ç–∞","—Ç–∞—Ä–µ–ª–∫–∞","—Ç–µ—Ç—Ä–∞–¥—å","—Ç–æ–≤–∞—Ä–∏—â","—Ç–æ–ø–æ—Ä","—É–ª–∏—Ü–∞","—É—Ä–æ–∂–∞–π",
"—É—á–µ–Ω–∏–∫","—É—á–µ–Ω–∏—Ü–∞","—É—á–∏—Ç–µ–ª—å","—É—á–∏—Ç–µ–ª—å–Ω–∏—Ü–∞","—Ñ–∞–º–∏–ª–∏—è","—Ñ–µ–≤—Ä–∞–ª—å","—Ö–æ—Ä–æ—à–æ","—â–∞–≤–µ–ª—å",
"—è–±–ª–æ–∫–æ","—è–±–ª–æ–Ω—è","—è–≥–æ–¥–∞","—è–∑—ã–∫","—è–Ω–≤–∞—Ä—å"
];

const ALPHABET = ['–∞','–±','–≤','–≥','–¥','–µ','—ë','–∂','–∑','–∏','–π','–∫','–ª','–º','–Ω','–æ','–ø','—Ä','—Å','—Ç','—É','—Ñ','—Ö','—Ü','—á','—à','—â','—ä','—ã','—å','—ç','—é','—è'];

let pool = [...WORDS].sort(()=>Math.random()-0.5);
let idx = 0;
let cur = '';
const answerEl = document.getElementById('answer');
const keyboardEl = document.getElementById('keyboard');
const feedback = document.getElementById('feedback');

function renderKeyboard(){
  keyboardEl.innerHTML='';
  ALPHABET.forEach(letter=>{
    const b = document.createElement('div');
    b.className='key';
    b.textContent = letter;
    b.addEventListener('click', ()=> addChar(letter));
    keyboardEl.appendChild(b);
  });
  // add space and backspace
  const space = document.createElement('div'); space.className='key'; space.style.minWidth='120px'; space.textContent='‚ê£ (–ø—Ä–æ–±–µ–ª)';
  space.addEventListener('click', ()=> addChar(' '));
  keyboardEl.appendChild(space);
  const back = document.createElement('div'); back.className='key'; back.textContent='‚å´';
  back.addEventListener('click', backspace);
  keyboardEl.appendChild(back);
}

function addChar(ch){
  answerEl.textContent += ch;
}

function backspace(){
  answerEl.textContent = answerEl.textContent.slice(0,-1);
}

function clearAnswer(){ answerEl.textContent = ''; }

function check(){
  const ans = answerEl.textContent.trim();
  if (ans.toLowerCase() === cur.toLowerCase()){
    feedback.style.color='green';
    feedback.textContent='–ü—Ä–∞–≤–∏–ª—å–Ω–æ! üéâ';
    idx++;
    setTimeout(()=> nextWord(), 700);
  } else {
    feedback.style.color='crimson';
    feedback.textContent='–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚Äî –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë.';
  }
}

function nextWord(){
  if (idx >= pool.length) {
    alert('–í—Å–µ —Å–ª–æ–≤–∞ –ø—Ä–æ–π–¥–µ–Ω—ã ‚Äî –Ω–∞—á–∏–Ω–∞–µ–º —Å–Ω–∞—á–∞–ª–∞.');
    idx = 0;
    pool.sort(()=>Math.random()-0.5);
  }
  cur = pool[idx];
  clearAnswer();
  feedback.textContent = '';
}

document.getElementById('playBtn').addEventListener('click', ()=> speakText(cur, 1.0));
document.getElementById('slowBtn').addEventListener('click', ()=> speakText(cur, 0.8));
document.getElementById('clearBtn').addEventListener('click', clearAnswer);
document.getElementById('submitBtn').addEventListener('click', check);
document.getElementById('nextBtn').addEventListener('click', ()=> { idx++; nextWord(); });

// Keyboard physical support
document.addEventListener('keydown', (e)=>{
  if (e.key === 'Backspace') { e.preventDefault(); backspace(); return; }
  if (e.key === 'Enter') { check(); return; }
  if (e.key === ' ') { addChar(' '); e.preventDefault(); return; }
  // support Russian letters when user uses Russian layout
  const k = e.key.toLowerCase();
  // only accept single-char russian letters (and '—ë')
  if (k.length === 1 && (ALPHABET.includes(k) || k === '—ë')) addChar(k);
});

/* --- TTS --- */
let voices = [];
function loadVoices(){ voices = speechSynthesis.getVoices() || []; }
speechSynthesis.onvoiceschanged = loadVoices;
loadVoices();

function chooseRussianVoice(){
  if (!voices.length) loadVoices();
  return voices.find(v=>v.lang && v.lang.toLowerCase().startsWith('ru')) || voices.find(v=>/russian/i.test(v.name)) || null;
}

function speakText(text, rate=1.0){
  if (!('speechSynthesis' in window)){ alert('TTS –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è'); return; }
  const u = new SpeechSynthesisUtterance(text);
  const v = chooseRussianVoice();
  if (v) u.voice = v;
  u.rate = rate;
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

/* init */
renderKeyboard();
nextWord();
</script>
</body>
</html>
